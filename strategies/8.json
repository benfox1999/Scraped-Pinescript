{"created":"2022-02-04T06:33:19.866277Z","extra":{"isAuto":false,"isBeta":false,"isBuiltIn":true,"isNew":false,"isPineEditorNewTemplate":true,"isUpdated":false,"kind":"strategy","sourceInputsCount":1},"lastVersionMaj":"28.0","scriptAccess":"open_no_auth","scriptName":"Keltner Channels Strategy","source":"//@version=5\nstrategy(title=\"Keltner Channels Strategy\", overlay=true)\nlength = input.int(20, minval=1)\nmult = input.float(2.0, \"Multiplier\")\nsrc = input(close, title=\"Source\")\nexp = input(true, \"Use Exponential MA\")\nBandsStyle = input.string(\"Average True Range\", options = [\"Average True Range\", \"True Range\", \"Range\"], title=\"Bands Style\")\natrlength = input(10, \"ATR Length\")\nesma(source, length)=>\n\ts = ta.sma(source, length)\n\te = ta.ema(source, length)\n\texp ? e : s\nma = esma(src, length)\nrangema = BandsStyle == \"True Range\" ? ta.tr(true) : BandsStyle == \"Average True Range\" ? ta.atr(atrlength) : ta.rma(high - low, length)\nupper = ma + rangema * mult\nlower = ma - rangema * mult\ncrossUpper = ta.crossover(src, upper)\ncrossLower = ta.crossunder(src, lower)\nbprice = 0.0\nbprice := crossUpper ? high+syminfo.mintick : nz(bprice[1])\nsprice = 0.0\nsprice := crossLower ? low -syminfo.mintick : nz(sprice[1])\ncrossBcond = false\ncrossBcond := crossUpper ? true\n     : na(crossBcond[1]) ? false : crossBcond[1]\ncrossScond = false\ncrossScond := crossLower ? true\n     : na(crossScond[1]) ? false : crossScond[1]\ncancelBcond = crossBcond and (src < ma or high >= bprice )\ncancelScond = crossScond and (src > ma or low <= sprice )\nif (cancelBcond)\n\tstrategy.cancel(\"KltChLE\")\nif (crossUpper)\n\tstrategy.entry(\"KltChLE\", strategy.long, stop=bprice, comment=\"KltChLE\")\nif (cancelScond)\n\tstrategy.cancel(\"KltChSE\")\nif (crossLower)\n\tstrategy.entry(\"KltChSE\", strategy.short, stop=sprice, comment=\"KltChSE\")","updated":"2022-02-04T06:33:19.866277Z","version":"28.0"}