{"created":"2023-03-31T08:55:59.898335Z","extra":{"isAuto":false,"isBeta":false,"isBuiltIn":true,"isNew":false,"isPineEditorNewTemplate":true,"isUpdated":false,"kind":"strategy","sourceInputsCount":0},"lastVersionMaj":"27.0","scriptAccess":"open_no_auth","scriptName":"Greedy Strategy","source":"//@version=5\nstrategy(\"Greedy Strategy\", pyramiding = 100, calc_on_order_fills=false, overlay=true)\ntp = input(10)\nsl = input(10)\nmaxidf = input(title=\"Max Intraday Filled Orders\", defval=5)\nstrategy.risk.max_intraday_filled_orders(maxidf)\nupGap = open > high[1]\ndnGap = open < low[1]\ndn = strategy.position_size < 0 and open > close\nup = strategy.position_size > 0 and open < close\nif upGap\n    strategy.entry(\"GapUp\", strategy.long, stop = high[1])\nelse\n    strategy.cancel(\"GapUp\")\nif dn\n    strategy.entry(\"Dn\", strategy.short, stop = close)\nelse\n    strategy.cancel(\"Dn\")\nif dnGap\n    strategy.entry(\"GapDn\", strategy.short, stop = low[1])\nelse\n    strategy.cancel(\"GapDn\")\nif up\n    strategy.entry(\"Up\", strategy.long, stop = close)\nelse\n    strategy.cancel(\"Up\")\nXQty = strategy.position_size < 0 ? -strategy.position_size : strategy.position_size\ndir = strategy.position_size < 0 ? -1 : 1\nlmP = strategy.position_avg_price + dir*tp*syminfo.mintick\nslP = strategy.position_avg_price - dir*sl*syminfo.mintick\nfloat nav = na\nrevCond = strategy.position_size > 0 ? dnGap : (strategy.position_size < 0 ? upGap : false)\nif not revCond and XQty > 0\n    strategy.order(\"TP\", strategy.position_size < 0 ? strategy.long : strategy.short, XQty, lmP, nav, \"TPSL\",  strategy.oca.reduce, \"TPSL\")\n    strategy.order(\"SL\", strategy.position_size < 0 ? strategy.long : strategy.short, XQty, nav, slP, \"TPSL\",  strategy.oca.reduce, \"TPSL\")\nif XQty == 0 or revCond\n    strategy.cancel(\"TP\")\n    strategy.cancel(\"SL\")\n//plot(strategy.equity, title=\"equity\", color=color.red, linewidth=2, style=plot.style_areabr)","updated":"2023-03-31T08:55:59.898335Z","version":"27.0"}