{"created":"2022-02-17T02:56:57.656414Z","extra":{"kind":"study","sourceInputsCount":1},"lastVersionMaj":"4.0","scriptAccess":"open_no_auth","scriptName":"_CM_MacD_Ult_MTF_V2.1","source":"//------New V2 Update 07-28-2021----------\r\n//Thanks to @SKTennis for help in Updating code to V2\r\n//Added Groups to Settings Pane.\r\n//Added Color Plots to Settings Pane\r\n//Switched MTF Logic to turn ON/OFF automatically w/ TradingView's Built in Feature\r\n//Updated Color Transparency plots to work in future update\r\n//Added Ability to Turn ON/OFF Show MacD & Signal Line\r\n//Added Ability to Turn ON/OFF Show Histogram\r\n//Added Ability to Change MACD Line Colors Based on Trend\r\n//Added Ability to Highlight Price Bars Based on Trend\r\n//Added Alerts to Settings Pane.\r\n//Customized how Alerts work.  Must keep Checked in Settings Pane, and...\r\n//When you go to Alerts Panel, Change Symbol to Indicator (CM_Ult_MacD_MTF_V2)\r\n//Customized Alerts to Show Symbol, TimeFrame, Closing Price, MACD Crosses Up & MACD Crosses Down Signals in Alert \r\n//Alerts are Pre-Set to only Alert on Bar Close\r\n\r\n//------New V2.1 Update 08-03-2021----------\r\n//Added back in ability to show Dots when MACD Crosses.\r\n//Added Ability to Change Plot Widths in Settings Pane\r\n//Added in Alert Feature where Cross Up if above 0 or cross down if below 0 (OFF By Default) user Request. @creid58\r\n//FIXED - Plot Orders to Default what Plots are on top of each other\r\n//FIXED - Two of the histogrm colors were backwrds\r\n\r\n//------New V2.1 Update 12-07-2021----------\r\n//Updated to PineScript V5\r\n\r\n//------Minor Update 02-16-2022----------\r\n//Per user request...Increased the Maxval for Signal Smoothing\r\n//Next Add in Plot Types to Settings Pane.\r\n//Next Add in more Moving Average types.\r\n//See Video for Detailed Overview\r\n\r\n//@version=5\r\nindicator(title=\"_CM_MacD_Ult_MTF_V2.1\", shorttitle=\"_CM_Ult_MacD_MTF_V2.1\")\r\n//Plot Inputs\r\nres           = input.timeframe(\"\",  \"Indicator TimeFrame\")\r\nfast_length   = input.int(title=\"Fast Length\", defval=12)\r\nslow_length   = input.int(title=\"Slow Length\", defval=26)\r\nsrc           = input.source(title=\"Source\", defval=close)\r\nsignal_length = input.int(title=\"Signal Smoothing\", minval = 1, maxval = 999, defval = 9)\r\nsma_source    = input.string(title=\"Oscillator MA Type\", defval=\"EMA\", options=[\"SMA\", \"EMA\"])\r\nsma_signal    = input.string(title=\"Signal Line MA Type\", defval=\"EMA\", options=[\"SMA\", \"EMA\"])\r\n// Show Plots T/F\r\nshow_macd     = input.bool(true, title=\"Show MACD Lines\", group=\"Show Plots?\", inline=\"SP10\")\r\nshow_macd_LW  = input.int(3, minval=0, maxval=5, title = \"MACD Width\", group=\"Show Plots?\", inline=\"SP11\")\r\nshow_signal_LW= input.int(2, minval=0, maxval=5, title = \"Signal Width\", group=\"Show Plots?\", inline=\"SP11\")\r\nshow_Hist     = input.bool(true, title=\"Show Histogram\", group=\"Show Plots?\", inline=\"SP20\")\r\nshow_hist_LW  = input.int(5, minval=0, maxval=5, title = \"-- Width\", group=\"Show Plots?\", inline=\"SP20\")\r\nshow_trend    = input.bool(true, title = \"Show MACD Lines w/ Trend Color\", group=\"Show Plots?\", inline=\"SP30\")\r\nshow_HB       = input.bool(false, title=\"Show Highlight Price Bars\", group=\"Show Plots?\", inline=\"SP40\")\r\nshow_cross    = input.bool(false, title = \"Show BackGround on Cross\", group=\"Show Plots?\", inline=\"SP50\")\r\nshow_dots     = input.bool(true, title = \"Show Circle on Cross\", group=\"Show Plots?\", inline=\"SP60\")\r\nshow_dots_LW  = input.int(5, minval=0, maxval=5, title = \"-- Width\", group=\"Show Plots?\", inline=\"SP60\")\r\n\r\n//show_trend    = input(true, title = \"Colors MACD Lines w/ Trend Color\", group=\"Show Plots?\", inline=\"SP5\")\r\n// MACD Lines colors\r\ncol_macd      = input.color(#FF6D00, \"MACD Line  \",  group=\"Color Settings\", inline=\"CS1\")\r\ncol_signal    = input.color(#2962FF, \"Signal Line  \",  group=\"Color Settings\", inline=\"CS1\")\r\ncol_trnd_Up   = input.color(#4BAF4F, \"Trend Up      \",  group=\"Color Settings\", inline=\"CS2\")\r\ncol_trnd_Dn   = input.color(#B71D1C, \"Trend Down    \",  group=\"Color Settings\", inline=\"CS2\")\r\n// Histogram Colors\r\ncol_grow_above = input.color(#26A69A, \"Above   Grow\",  group=\"Histogram Colors\", inline=\"Hist10\")\r\ncol_fall_above = input.color(#B2DFDB, \"Fall\",  group=\"Histogram Colors\", inline=\"Hist10\")\r\ncol_grow_below = input.color(#FF5252, \"Below Grow\",  group=\"Histogram Colors\", inline=\"Hist20\")\r\ncol_fall_below = input.color(#FFCDD2, \"Fall\",  group=\"Histogram Colors\", inline=\"Hist20\")\r\n// Alerts T/F Inputs\r\nalert_Long    = input.bool(true, title = \"MACD Cross Up\", group = \"Alerts\", inline=\"Alert10\")\r\nalert_Short   = input.bool(true, title = \"MACD Cross Dn\", group = \"Alerts\", inline=\"Alert10\")\r\nalert_Long_A  = input.bool(false, title = \"MACD Cross Up & > 0\", group = \"Alerts\", inline=\"Alert20\")\r\nalert_Short_B = input.bool(false, title = \"MACD Cross Dn & < 0\", group = \"Alerts\", inline=\"Alert20\")\r\n// Calculating\r\nfast_ma = request.security(syminfo.tickerid, res, sma_source == \"SMA\" ? ta.sma(src, fast_length) : ta.ema(src, fast_length))\r\nslow_ma = request.security(syminfo.tickerid, res, sma_source == \"SMA\" ? ta.sma(src, slow_length) : ta.ema(src, slow_length))\r\nmacd = fast_ma - slow_ma\r\nsignal = request.security(syminfo.tickerid, res, sma_signal == \"SMA\" ? ta.sma(macd, signal_length) : ta.ema(macd, signal_length))\r\nhist = macd - signal\r\n// MACD Trend and Cross Up/Down conditions\r\ntrend_up   = macd > signal\r\ntrend_dn   = macd < signal\r\ncross_UP   = signal[1] >= macd[1] and signal < macd\r\ncross_DN   = signal[1] <= macd[1] and signal > macd\r\ncross_UP_A = (signal[1] >= macd[1] and signal < macd) and macd > 0\r\ncross_DN_B = (signal[1] <= macd[1] and signal > macd) and macd < 0\r\n// Condition that changes Color of MACD Line if Show Trend is turned on..\r\ntrend_col = show_trend  and trend_up ? col_trnd_Up : trend_up ? col_macd : show_trend  and trend_dn ? col_trnd_Dn: trend_dn ? col_macd : na \r\n\r\n//Var Statements for Histogram Color Change\r\nvar bool histA_IsUp = false\r\nvar bool histA_IsDown = false\r\nvar bool histB_IsDown = false\r\nvar bool histB_IsUp = false\r\nhistA_IsUp   := hist == hist[1] ? histA_IsUp[1] : hist > hist[1] and hist > 0\r\nhistA_IsDown := hist == hist[1] ? histA_IsDown[1] : hist < hist[1] and hist > 0\r\nhistB_IsDown := hist == hist[1] ? histB_IsDown[1] : hist < hist[1] and hist <= 0\r\nhistB_IsUp   := hist == hist[1] ? histB_IsUp[1] : hist > hist[1] and hist <= 0\r\n\r\nhist_col =  histA_IsUp ? col_grow_above : histA_IsDown ? col_fall_above : histB_IsDown ? col_grow_below : histB_IsUp ? col_fall_below :color.silver \r\n\r\n// Plot Statements\r\n//Background Color\r\nbgcolor(show_cross and cross_UP ? col_trnd_Up : na, editable=false)\r\nbgcolor(show_cross and cross_DN ? col_trnd_Dn : na, editable=false)\r\n//Highlight Price Bars\r\nbarcolor(show_HB and trend_up ? col_trnd_Up : na, title=\"Trend Up\", offset = 0, editable=false)\r\nbarcolor(show_HB and trend_dn ? col_trnd_Dn : na, title=\"Trend Dn\", offset = 0, editable=false)\r\n//Regular Plots\r\nplot(show_Hist and hist ? hist : na, title=\"Histogram\", style=plot.style_columns, color=color.new(hist_col ,0),linewidth=show_hist_LW)\r\nplot(show_macd  and signal ? signal : na, title=\"Signal\", color=color.new(col_signal, 0),  style=plot.style_line ,linewidth=show_signal_LW)\r\nplot(show_macd  and macd ? macd : na, title=\"MACD\", color=color.new(trend_col, 0),  style=plot.style_line ,linewidth=show_macd_LW)\r\nhline(0, title=\"0 Line\", color=color.new(color.gray, 0), linestyle=hline.style_dashed, linewidth=1, editable=false)\r\nplot(show_dots and cross_UP ? macd : na, title=\"Dots\", color=color.new(trend_col ,0), style=plot.style_circles, linewidth=show_dots_LW, editable=false)\r\nplot(show_dots and cross_DN ? macd : na, title=\"Dots\", color=color.new(trend_col ,0), style=plot.style_circles, linewidth=show_dots_LW, editable=false)\r\n\r\n//Alerts\r\nif alert_Long and cross_UP\r\n    alert(\"Symbol = (\" + syminfo.tickerid + \") TimeFrame = (\" + timeframe.period + \") Current Price (\" + str.tostring(close) + \") MACD Crosses Up.\", alert.freq_once_per_bar_close)\r\n\r\nif alert_Short and cross_DN\r\n    alert(\"Symbol = (\" + syminfo.tickerid + \") TimeFrame = (\" + timeframe.period + \") Current Price (\" + str.tostring(close) + \") MACD Crosses Down.\", alert.freq_once_per_bar_close)\r\n//Alerts - Stricter Condition - Only Alerts When MACD Crosses UP & MACD > 0 -- Crosses Down & MACD < 0\r\nif alert_Long_A and cross_UP_A\r\n    alert(\"Symbol = (\" + syminfo.tickerid + \") TimeFrame = (\" + timeframe.period + \") Current Price (\" + str.tostring(close) + \") MACD > 0 And Crosses Up.\", alert.freq_once_per_bar_close)\r\n\r\nif alert_Short_B and cross_DN_B\r\n    alert(\"Symbol = (\" + syminfo.tickerid + \") TimeFrame = (\" + timeframe.period + \") Current Price (\" + str.tostring(close) + \") MACD < 0 And Crosses Down.\", alert.freq_once_per_bar_close)\r\n\r\n//End Code","updated":"2022-02-17T02:56:57.656414Z","version":"4.0"}