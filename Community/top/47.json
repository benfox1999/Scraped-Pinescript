{"created":"2023-07-19T19:17:07.331953Z","extra":{"kind":"study","sourceInputsCount":0},"lastVersionMaj":"6.0","scriptAccess":"open_no_auth","scriptName":"Swing Highs/Lows & Candle Patterns [LuxAlgo]","source":"// This work is licensed under a Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) https://creativecommons.org/licenses/by-nc-sa/4.0/\r\n// © LuxAlgo\r\n\r\n//@version=5\r\nindicator(\"Swing Highs/Lows & Candle Patterns [LuxAlgo]\", \"LuxAlgo - Swing Highs/Lows & Candle Patterns\", overlay = true, max_labels_count = 500)\r\n//------------------------------------------------------------------------------\r\n//Settings\r\n//-----------------------------------------------------------------------------{\r\nlength = input(21)\r\n\r\n//Style\r\nswinghCss = input(color.red, 'Swing High', group = 'Style')\r\nswinglCss = input(color.teal, 'Swing Low', group = 'Style')\r\n\r\n//-----------------------------------------------------------------------------}\r\n//Descriptions\r\n//-----------------------------------------------------------------------------{\r\nhammer_ = \"The hammer candlestick pattern is formed of a short body with a long lower wick, and is found at the bottom of a downward trend.\"\r\n  + \"\\n\" + \"\\n A hammer shows that although there were selling pressures during the day, ultimately a strong buying pressure drove the price back up.\" \r\nihammer_ = \"The inverted hammer is a similar pattern than the hammer pattern. The only difference being that the upper wick is long, while the lower wick is short.\"\r\n  + \"\\n\" + \"\\n It indicates a buying pressure, followed by a selling pressure that was not strong enough to drive the market price down. The inverse hammer suggests that buyers will soon have control of the market.\"\r\nbulleng_ = \"The bullish engulfing pattern is formed of two candlesticks. The first candle is a short red body that is completely engulfed by a larger green candle\"\r\n  + \"\\n\" + \"\\n Though the second day opens lower than the first, the bullish market pushes the price up, culminating in an obvious win for buyers\"\r\nhanging_ = \"The hanging man is the bearish equivalent of a hammer; it has the same shape but forms at the end of an uptrend.\"\r\n  + \"\\n\" + \"It indicates that there was a significant sell-off during the day, but that buyers were able to push the price up again. The large sell-off is often seen as an indication that the bulls are losing control of the market.\"\r\nshooting_ = \"The shooting star is the same shape as the inverted hammer, but is formed in an uptrend: it has a small lower body, and a long upper wick.\"\r\n  + \"\\n\" + \"Usually, the market will gap slightly higher on opening and rally to an intra-day high before closing at a price just above the open – like a star falling to the ground.\"\r\nbeareng_ = \"A bearish engulfing pattern occurs at the end of an uptrend. The first candle has a small green body that is engulfed by a subsequent long red candle.\"\r\n  + \"\\n\" + \"It signifies a peak or slowdown of price movement, and is a sign of an impending market downturn. The lower the second candle goes, the more significant the trend is likely to be.\"\r\n\r\n//-----------------------------------------------------------------------------}\r\n//UDT\r\n//-----------------------------------------------------------------------------{\r\ntype pattern\r\n    bool condition\r\n    string title\r\n    string description\r\n  \r\n//-----------------------------------------------------------------------------}\r\n//Data\r\n//-----------------------------------------------------------------------------{\r\nvar float phy = na\r\nvar float ply = na\r\n\r\no = open[length]\r\nh = high[length]\r\nl = low[length]\r\nc = close[length]\r\n\r\nd = math.abs(c - o)\r\nph = ta.pivothigh(length, length)\r\npl = ta.pivotlow(length, length)\r\n\r\n//-----------------------------------------------------------------------------{\r\n//Patterns\r\n//-----------------------------------------------------------------------------}\r\nhammer   = pattern.new(pl and math.min(o,c) - l > d and h - math.max(c,o) < d, 'Hammer', hammer_)\r\nihammer  = pattern.new(pl and h - math.max(c,o) > d and math.min(c,o) - l < d, 'Inverted Hammer', ihammer_)\r\nbulleng  = pattern.new(c > o and c[1] < o[1] and c > o[1] and o < c[1], 'Bullish Engulfing', bulleng_)\r\nhanging  = pattern.new(ph and math.min(c,o) - l > d and h - math.max(o,c) < d, 'Hanging Man', hanging_)\r\nshooting = pattern.new(ph and h - math.max(o,c) > d and math.min(c,o) - l < d, 'Shooting Star', shooting_)\r\nbeareng  = pattern.new(c > o and c[1] < o[1] and c > o[1] and o < c[1], 'Bearish Engulfing', beareng_)\r\n\r\n//-----------------------------------------------------------------------------}\r\n//Set labels\r\n//-----------------------------------------------------------------------------{\r\nn = bar_index\r\n\r\npattern pattern_obj = hammer.condition ? hammer\r\n  : ihammer.condition ? ihammer\r\n  : bulleng.condition ? bulleng\r\n  : hanging.condition ? hanging\r\n  : shooting.condition ? shooting\r\n  : beareng.condition ? beareng\r\n  : na\r\n\r\nif ph\r\n    H = ph > phy ? 'HH' : 'LH'\r\n\r\n    //Set label\r\n    label.new(n[length], ph\r\n      , H + \"\\n\" + (na(pattern_obj) ? 'None' : pattern_obj.title)\r\n      , color = color(na)\r\n      , style = label.style_label_down\r\n      , textcolor = swinghCss\r\n      , tooltip = na(pattern_obj) ? '' : pattern_obj.description)\r\n    \r\n    phy := ph\r\n\r\nelse if pl\r\n    L = pl < ply ? 'LL' : 'HL'\r\n\r\n    //Set label\r\n    label.new(n[length], pl\r\n      , L + \"\\n\" + (na(pattern_obj) ? 'None' : pattern_obj.title)\r\n      , color = color(na)\r\n      , style = label.style_label_up\r\n      , textcolor = swinglCss\r\n      , tooltip = na(pattern_obj) ? '' : pattern_obj.description)\r\n\r\n    ply := pl\r\n\r\n//-----------------------------------------------------------------------------}","updated":"2023-07-19T19:17:07.331953Z","version":"6.0"}