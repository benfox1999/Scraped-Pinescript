{"extra":{},"lastVersionMaj":"-1.0","scriptAccess":"open_no_auth","scriptName":"CM_Ultimate_MA_MTF_V2","source":"//Created by user ChrisMoody 4-24-2014...Updated 7/28/2014 added Tilson T3\r\n//Modified on 5-5-14 for 4apprentice08 with Optional BarColor based on Price  Crossing MA #1, or #2\r\n//Modified on 7-25-2014 to Add in Tilson T3\r\n//Plots The Majority of Moving Averages\r\n//Defaults to Current Chart Time Frame --- But Can Be Changed to Higher Or Lower Time Frames\r\n//2nd MA Capability with Show Crosses Feature\r\nstudy(title=\"CM_Ultimate_MA_MTF_V2\", shorttitle=\"CM_Ultimate_MA_MTF_V2\", overlay=true)\r\n//inputs\r\nsrc = close\r\nuseCurrentRes = input(true, title=\"Use Current Chart Resolution?\")\r\nresCustom = input(title=\"Use Different Timeframe? Uncheck Box Above\", type=resolution, defval=\"D\")\r\nlen = input(20, title=\"Moving Average Length - LookBack Period\")\r\n//periodT3 = input(defval=7, title=\"Tilson T3 Period\", minval=1) \r\nfactorT3 = input(defval=7, title=\"Tilson T3 Factor - *.10 - so 7 = .7 etc.\", minval=0) \r\natype = input(1,minval=1,maxval=8,title=\"1=SMA, 2=EMA, 3=WMA, 4=HullMA, 5=VWMA, 6=RMA, 7=TEMA, 8=Tilson T3\")\r\nspc=input(false, title=\"Show Price Crossing 1st Mov Avg - Highlight Bar?\")\r\ncc = input(true,title=\"Change Color Based On Direction?\")\r\nsmoothe = input(2, minval=1, maxval=10, title=\"Color Smoothing - Setting 1 = No Smoothing\")\r\ndoma2 = input(false, title=\"Optional 2nd Moving Average\")\r\nspc2=input(false, title=\"Show Price Crossing 2nd Mov Avg?\")\r\nlen2 = input(50, title=\"Moving Average Length - Optional 2nd MA\")\r\nsfactorT3 = input(defval=7, title=\"Tilson T3 Factor - *.10 - so 7 = .7 etc.\", minval=0)\r\natype2 = input(1,minval=1,maxval=8,title=\"1=SMA, 2=EMA, 3=WMA, 4=HullMA, 5=VWMA, 6=RMA, 7=TEMA, 8=Tilson T3\")\r\ncc2 = input(true,title=\"Change Color Based On Direction 2nd MA?\")\r\nwarn = input(false, title=\"***You Can Turn On The Show Dots Parameter Below Without Plotting 2nd MA to See Crosses***\")\r\nwarn2 = input(false, title=\"***If Using Cross Feature W/O Plotting 2ndMA - Make Sure 2ndMA Parameters are Set Correctly***\")\r\nsd = input(false, title=\"Show Dots on Cross of Both MA's\")\r\n\r\nres = useCurrentRes ? period : resCustom\r\n//hull ma definition\r\nhullma = wma(2*wma(src, len/2)-wma(src, len), round(sqrt(len)))\r\n//TEMA definition\r\nema1 = ema(src, len)\r\nema2 = ema(ema1, len)\r\nema3 = ema(ema2, len)\r\ntema = 3 * (ema1 - ema2) + ema3\r\n\r\n//Tilson T3\r\nfactor = factorT3 *.10\r\ngd(src, len, factor) => ema(src, len) * (1 + factor) - ema(ema(src, len), len) * factor \r\nt3(src, len, factor) => gd(gd(gd(src, len, factor), len, factor), len, factor) \r\ntilT3 = t3(src, len, factor) \r\n \r\n\r\navg = atype == 1 ? sma(src,len) : atype == 2 ? ema(src,len) : atype == 3 ? wma(src,len) : atype == 4 ? hullma : atype == 5 ? vwma(src, len) : atype == 6 ? rma(src,len) : atype == 7 ? 3 * (ema1 - ema2) + ema3 : tilT3\r\n//2nd Ma - hull ma definition\r\nhullma2 = wma(2*wma(src, len2/2)-wma(src, len2), round(sqrt(len2)))\r\n//2nd MA TEMA definition\r\nsema1 = ema(src, len2)\r\nsema2 = ema(sema1, len2)\r\nsema3 = ema(sema2, len2)\r\nstema = 3 * (sema1 - sema2) + sema3\r\n\r\n//2nd MA Tilson T3\r\nsfactor = sfactorT3 *.10\r\nsgd(src, len2, sfactor) => ema(src, len2) * (1 + sfactor) - ema(ema(src, len2), len2) * sfactor \r\nst3(src, len2, sfactor) => sgd(sgd(gd(src, len2, sfactor), len2, sfactor), len2, sfactor) \r\nstilT3 = st3(src, len2, sfactor) \r\n\r\navg2 = atype2 == 1 ? sma(src,len2) : atype2 == 2 ? ema(src,len2) : atype2 == 3 ? wma(src,len2) : atype2 == 4 ? hullma2 : atype2 == 5 ? vwma(src, len2) : atype2 == 6 ? rma(src,len2) : atype2 == 7 ? 3 * (ema1 - ema2) + ema3 : stilT3\r\n\r\nout = avg \r\nout_two = avg2\r\n\r\nout1 = security(tickerid, res, out)\r\nout2 = security(tickerid, res, out_two)\r\n\r\n//Formula for Price Crossing Moving Average #1\r\ncr_up = open < out1 and close > out1\r\ncr_Down = open > out1 and close < out1\r\n//Formula for Price Crossing Moving Average #2\r\ncr_up2 = open < out2 and close > out2\r\ncr_Down2 = open > out2 and close < out2\r\n//barcolor Criteria for Price Crossing Moving Average #1\r\niscrossUp() => cr_up\r\niscrossDown() => cr_Down\r\n//barcolor Criteria for Price Crossing Moving Average #2\r\niscrossUp2() => cr_up2\r\niscrossDown2() => cr_Down2\r\n\r\nma_up = out1 >= out1[smoothe]\r\nma_down = out1 < out1[smoothe]\r\n\r\ncol = cc ? ma_up ? lime : ma_down ? red : aqua : aqua\r\ncol2 = cc2 ? ma_up ? lime : ma_down ? red : aqua : white\r\n\r\ncircleYPosition = out2\r\n\r\nplot(out1, title=\"Multi-Timeframe Moving Avg\", style=line, linewidth=4, color = col)\r\nplot(doma2 and out2 ? out2 : na, title=\"2nd Multi-TimeFrame Moving Average\", style=circles, linewidth=4, color=col2)\r\nplot(sd and cross(out1, out2) ? circleYPosition : na,style=cross, linewidth=15, color=aqua)\r\n//barcolor Plot for Price Crossing Moving Average #1\r\nbarcolor(spc and iscrossUp() ? (iscrossUp() ? yellow : na) : na)\r\nbarcolor(spc and iscrossDown() ? (iscrossDown() ? yellow : na) : na)\r\n//barcolor Plot for Price Crossing Moving Average #2\r\nbarcolor(spc2 and iscrossUp2() ? (iscrossUp2() ? yellow : na) : na)\r\nbarcolor(spc2 and iscrossDown2() ? (iscrossDown2() ? yellow : na) : na)","version":"-1.0"}