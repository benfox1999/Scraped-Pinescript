{"created":"2021-10-04T12:42:26.264845Z","extra":{"kind":"study","sourceInputsCount":0},"lastVersionMaj":"3.0","scriptAccess":"open_no_auth","scriptName":"Pivot Point SuperTrend","source":"// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/\r\n// Â© LonesomeTheBlue\r\n\r\n//@version=4\r\nstudy(\"Pivot Point SuperTrend\", overlay = true)\r\nprd = input(defval = 2, title=\"Pivot Point Period\", minval = 1, maxval = 50)\r\nFactor=input(defval = 3, title = \"ATR Factor\", minval = 1, step = 0.1)\r\nPd=input(defval = 10, title = \"ATR Period\", minval=1)\r\nshowpivot = input(defval = false, title=\"Show Pivot Points\")\r\nshowlabel = input(defval = true, title=\"Show Buy/Sell Labels\")\r\nshowcl = input(defval = false, title=\"Show PP Center Line\")\r\nshowsr = input(defval = false, title=\"Show Support/Resistance\")\r\n\r\n// get Pivot High/Low\r\nfloat ph = pivothigh(prd, prd)\r\nfloat pl = pivotlow(prd, prd)\r\n\r\n// drawl Pivot Points if \"showpivot\" is enabled\r\nplotshape(ph and showpivot, text=\"H\",  style=shape.labeldown, color=na, textcolor=color.red, location=location.abovebar, transp=0, offset = -prd)\r\nplotshape(pl and showpivot, text=\"L\",  style=shape.labeldown, color=na, textcolor=color.lime, location=location.belowbar, transp=0, offset = -prd)\r\n\r\n// calculate the Center line using pivot points\r\nvar float center = na\r\nfloat lastpp = ph ? ph : pl ? pl : na\r\nif lastpp\r\n    if na(center)\r\n        center := lastpp\r\n    else\r\n        //weighted calculation\r\n        center := (center * 2 + lastpp) / 3\r\n\r\n// upper/lower bands calculation\r\nUp = center - (Factor * atr(Pd))\r\nDn = center + (Factor * atr(Pd))\r\n\r\n// get the trend\r\nfloat TUp = na\r\nfloat TDown = na\r\nTrend = 0\r\nTUp := close[1] > TUp[1] ? max(Up, TUp[1]) : Up\r\nTDown := close[1] < TDown[1] ? min(Dn, TDown[1]) : Dn\r\nTrend := close > TDown[1] ? 1: close < TUp[1]? -1: nz(Trend[1], 1)\r\nTrailingsl = Trend == 1 ? TUp : TDown\r\n\r\n// plot the trend\r\nlinecolor = Trend == 1 and nz(Trend[1]) == 1 ? color.lime : Trend == -1 and nz(Trend[1]) == -1 ? color.red : na\r\nplot(Trailingsl, color = linecolor ,  linewidth = 2, title = \"PP SuperTrend\")\r\n \r\nplot(showcl ? center : na, color = showcl ? center < hl2 ? color.blue : color.red : na)\r\n\r\n// check and plot the signals\r\nbsignal = Trend == 1 and Trend[1] == -1\r\nssignal = Trend == -1 and Trend[1] == 1\r\nplotshape(bsignal and showlabel ? Trailingsl : na, title=\"Buy\", text=\"Buy\", location = location.absolute, style = shape.labelup, size = size.tiny, color = color.lime, textcolor = color.black, transp = 0)\r\nplotshape(ssignal and showlabel ? Trailingsl : na, title=\"Sell\", text=\"Sell\", location = location.absolute, style = shape.labeldown, size = size.tiny, color = color.red, textcolor = color.white, transp = 0)\r\n\r\n//get S/R levels using Pivot Points\r\nfloat resistance = na\r\nfloat support = na\r\nsupport := pl ? pl : support[1]\r\nresistance := ph ? ph : resistance[1]\r\n\r\n// if enabled then show S/R levels\r\nplot(showsr and support ? support : na, color = showsr and support ? color.lime : na, style = plot.style_circles, offset = -prd)\r\nplot(showsr and resistance ? resistance : na, color = showsr and resistance ? color.red : na, style = plot.style_circles, offset = -prd)\r\n\r\n// alerts\r\nalertcondition(Trend == 1 and Trend[1] == -1, title='Buy Signal', message='Buy Signal')\r\nalertcondition(Trend == -1 and Trend[1] == 1, title='Sell Signal', message='Sell Signal')\r\nalertcondition(change(Trend), title='Trend Changed', message='Trend Changed')\r\n","updated":"2021-10-04T12:42:26.264845Z","version":"3.0"}